(()=>{var o=class{constructor(e,t,i){this.x=0;this.y=0;this.width=e,this.height=t,this.scene=i}focusOn(e,t,i,n){this.x=e-this.width/2,this.y=t-this.height/2,this.x=Math.max(0,Math.min(this.x,i-this.width)),this.y=Math.max(0,Math.min(this.y,n-this.height))}updateAndRender(e,t){t.clearRect(0,0,t.canvas.width,t.canvas.height),this.scene.gameObjects.forEach(i=>{let n=i.x-this.x,s=i.y-this.y;n+this.width>=0&&n<=this.width&&s+this.height>=0&&s<=this.height&&(i.update(e),i.render(t))})}};var h=class{constructor(e){this.lastTime=0;this.currentCamera=null;let t=document.getElementById(e),i=t.getContext("2d");if(!i)throw new Error("Unable to get canvas rendering context.");this.canvas=t,this.ctx=i,this.callbacks=[]}start(){requestAnimationFrame(this.gameLoop.bind(this))}gameLoop(e){let t=(e-this.lastTime)/1e3;this.lastTime=e,this.currentCamera&&this.currentCamera.updateAndRender(t,this.ctx),this.callbacks&&this.callbacks.forEach(i=>i(t)),requestAnimationFrame(this.gameLoop.bind(this))}changeCamera(e){this.currentCamera=e}addCallback(e){this.callbacks.push(e)}getCanvas(){return this.canvas}};var g={};window.addEventListener("keydown",r=>{g[r.code]=!0});window.addEventListener("keyup",r=>{g[r.code]=!1});var a={x:0,y:0,clicked:!1};function p(r,e){r.addEventListener("click",t=>{let i=r.getBoundingClientRect(),n=t.clientX-i.left,s=t.clientY-i.top;a.x=n+e.x,a.y=s+e.y,a.clicked=!0})}var c=class{constructor(e,t){this.width=e,this.height=t,this.gameObjects=[]}addGameObject(e){this.gameObjects.push(e)}removeGameObject(e){let t=this.gameObjects.indexOf(e);console.log(t),console.log(JSON.stringify(e)),console.log(JSON.stringify(this.gameObjects)),t!==-1&&this.gameObjects.splice(t,1)}};var u=class{constructor(e,t,i,n,s,m,f,x,v,w,C=.3){this.image=new Image,this.image.src=e,this.currentFrameIndex=0,this.showWidth=v,this.showHight=w,this.frameDuration=C,this.elapsedTime=0,this.frames=[];for(let b=0;b<n;b++){let y={x:t*b+s,y:m,width:f,hight:x};this.frames.push(y)}}update(e){this.elapsedTime+=e,this.elapsedTime>=this.frameDuration&&(this.currentFrameIndex++,this.currentFrameIndex>=this.frames.length&&(this.currentFrameIndex=0),this.elapsedTime-=this.frameDuration)}render(e,t,i){let n=this.frames[this.currentFrameIndex];i.drawImage(this.image,n.x,n.y,n.width,n.hight,e,t,this.showWidth,this.showHight)}};var d=class{constructor(e,t,i){this.x=e,this.y=t,this.currentAnimation=i}update(e){this.currentAnimation.update(e)}render(e){this.currentAnimation.render(this.x,this.y,e)}};var l=class extends d{targetX=null;targetY=null;constructor(e,t){let i=new u("./assets/soldierwithshadows/Soldier-Idle.png",100,100,6,35,35,30,30,50,50);super(e,t,i)}update(e){if(super.update(e),a.clicked&&(this.targetX=a.x,this.targetY=a.y,a.clicked=!1),this.targetX!==null&&this.targetY!==null){let t=this.targetX-this.x,i=this.targetY-this.y,n=Math.sqrt(t*t+i*i);if(n>1){let s=t/n,m=i/n;this.x+=s*100*e,this.y+=m*100*e}else this.x=this.targetX,this.y=this.targetY,this.targetX=null,this.targetY=null}}};window.addEventListener("load",()=>{let r=new h("gameCanvas"),e=r.getCanvas(),t=e.width,i=e.height,n=new c(t,i),s=new o(t,i,n);p(e,s);let m=new l(50,50);s.scene.gameObjects.push(m),r.changeCamera(s),r.start()});})();
/**
 * @author       Georgii Kharlampiiev <georgii@artcraft.games>
 * @copyright    2024 ArtCraft Supplies Inc.
 * @license      {@link https://opensource.org/licenses/MIT|MIT License}
 */
